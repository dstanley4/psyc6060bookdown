[
["sampling-precision.html", "Chapter 6 Sampling Precision 6.1 Overview 6.2 Population / Individuals 6.3 Sampling distribution 6.4 Precision indices 6.5 A short cut 6.6 Estimates of precision 6.7 Bias of precision estimates 6.8 Where are we? 6.9 Factors influencing precision 6.10 Precision for other statistics", " Chapter 6 Sampling Precision 6.1 Overview In the previous chapter we focused on examining the extent to which we could estimate a population parameter from a statistic in an unbiased manner. That is, we focused on the fact that, due to sampling error, a sample estimate (i.e., a statistic) of a population parameter will likely be wrong. Sample statistics may overestimate, or underestimate, a population parameter - often substantially. Consequently, we learned to think about the accuracy of sample statistics. More specifically, we learned to think about accuracy not in terms of a single study, but rather in terms of whether sample statistics correctly estimate the population parameter on average over many studies (as illustrated in Figure 6.1). When the average of many sample statistics (e.g., sample means) equals the population parameter (e.g., population mean) there is no bias and the sample statistic can be considered accurate (on average). In this chapter, we assume there is no bias and that sample means are, on average, accurate. In doing so, we focus now on the precision of sample means as estimates of the population mean, see Figure 6.1. That is, assuming no bias, when you conduct a single study you know the sample mean will differ from the population mean due to sampling error. You might wonder, how much does my sample mean differ from the population mean? That’s the question we address in this chapter. When we conduct a single study we can’t know how much that particular sample mean differs from the population mean, but we can estimate the extent to which sample means differ from the population mean in general. We focus on two indices of precision – variance of sample mean and standard error of sample means. By the end of the chapter you will understand how to a) conceptualize these indices with respect to a large number of samples/studies and b) estimate them for a single study. FIGURE 6.1: Sampling accuracy and precision 6.2 Population / Individuals We use a population of heights to learn about random sampling and the precision of sample estimates. We can obtain that population with the code below: library(tidyverse) library(learnSampling) pop_data &lt;- get_height_population() The glimpse() command can be used to confirm that the population contains 100,000 people. glimpse(pop_data) ## Rows: 100,000 ## Columns: 3 ## $ id &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,… ## $ sex &lt;chr&gt; &quot;male&quot;, &quot;female&quot;, &quot;female&quot;, &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, &quot;female&quot;, … ## $ height &lt;dbl&gt; 177, 150, 171, 157, 169, 187, 163, 173, 172, 193, 190, 181, 15… We can use the head() command to see the first 10 rows of the 100,00 rows. We see that each row in pop_data represents a single person. There is a column called height that contains the height for everyone in the population. head(pop_data, 10) ## # A tibble: 10 x 3 ## id sex height ## &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 1 male 177 ## 2 2 female 150 ## 3 3 female 171 ## 4 4 male 157 ## 5 5 male 169 ## 6 6 male 187 ## 7 7 female 163 ## 8 8 male 173 ## 9 9 female 172 ## 10 10 male 193 We can calculate the descriptive parameters for the population with the code below: pop_data %&gt;% summarise(pop_mean = mean(height), pop_var = var.pop(height), pop_sd = sd.pop(height)) %&gt;% as.data.frame() ## pop_mean pop_var pop_sd ## 1 172.4762 157.4611 12.54835 We see the mean of the population of heights is 172.5 (\\(\\mu = 172.5\\)) and the variance is 157.5 (\\(\\sigma^2 = 157.5\\)). Correspondingly, the standard deviation of the population of heights is 12.5 (\\(\\sigma = 12.5\\)); simply the square root of the variance. \\[ \\begin{aligned} \\mu &amp;= 172.5 \\\\ \\sigma^2 &amp;= 157.5 \\\\ \\sigma &amp;= 12.5 \\\\ \\end{aligned} \\] 6.3 Sampling distribution A sampling distribution is composed of an infinite number of samples. For pedagogical purposes, we will use a sampling distribution of just 50000 samples. This large number of samples will lead us to roughly the same conclusions as using an infinite, but impractical, number of samples. We obtain 50000 samples with code below: many_samples &lt;- get_M_samples(pop.data = pop_data, pop.column.name = height, n = 50, number.of.samples = 50000) We can use the head() command to see the first few rows of many_samples. Every row represents a sample of 10 people. That is, each row represents a study with 10 participants for which we measured their heights. For each row/study we have the sample mean and variance (using n-1) for the 10 heights. head(many_samples) ## study n sample.mean sample.var.n sample.var.n_1 ## 1 1 10 174.3 27.810 30.90 ## 2 2 10 161.8 83.358 92.62 ## 3 3 10 173.2 139.158 154.62 ## 4 4 10 180.0 321.804 357.56 ## 5 5 10 172.8 160.956 178.84 ## 6 6 10 172.0 159.597 177.33 We will study the precision of sample means as estimates of the population mean using the values in the sample.mean column. Each of the 50000 values in the sample.mean column is a sample mean (\\(\\bar{x}\\)), based on \\(n\\) = 10. Each sample mean provides an estimate of the population mean (\\(\\mu = 172.5\\)). Sample means often overestimate, or underestimate, the population mean. We can see this using the code below which reveals that the smallest sample mean is 155.6 (\\(\\bar{x} = 155.6\\)) and the largest sample mean is 188.8 (\\(\\bar{x} = 188.8\\)). Both are estimates of the population mean (\\(\\mu = 172.5\\)) but differ from that value due to sampling error (i.e., the fact that sample means are based on a small subset of the population). You can see that the conclusions of any single study may differ rather substantially from what is true for the overall population. many_samples %&gt;% summarise(min_mean = min(sample.mean), max_mean = max(sample.mean)) ## min_mean max_mean ## 1 155.6 188.8 The 50000 means in the sample.mean column form a sampling distribution; specifically, the sampling distribution of the mean. It’s critical to distinguish between a) the distribution of the sample means and b) the distribution of population heights. Examine Figure 6.2 below. The top part of this figure illustrates the variability in the heights for the 100,000 people (represented by X’s). There are more people than X’s; the X’s are a reminder it is a distribution of people’s heights. The bottom part of this figure illustrates the variability in sample means - each based on 10 people. Each sample mean is an estimate of the mean height of the population (172.5 cm). There are more sample means than \\(\\bar{x}\\)’s; the \\(\\bar{x}\\)’s are a reminder it is a distribution of sample means. When we describe how precisely sample means estimate the mean height for the population we are referring to the width of this distribution of means. FIGURE 6.2: Sampling distribution of the mean. The population of individuals is presented at the top and filled with X’s to remind you they are individuals. There are more individuals than X’s. The sampling distribution of means is presented in the bottom part of the graph. The sampling distribution of means is filled with \\(\\bar{x}\\)’s to remind you that sample means are being graphed. There are more means than \\(\\bar{x}\\)’s. The population mean (green line) and the mean of sample means (blue line) are in the same spot, indicating high accuracy (i.e., no bias). 6.4 Precision indices The most common way of referring to the width of this distribution of sample means is with the term standard error. Standard error is simply the standard deviation of the sample means. We calculate the standard error of the mean using Formula (6.1) below. We use \\(k\\) in the formula to refer to the number of sample means in the distribution. \\[\\begin{equation} \\sigma_{\\bar{x}} = \\sqrt{\\frac{\\sum{(\\bar{x} - \\bar{\\bar{x}})^2}}{k}} \\tag{6.1} \\end{equation}\\] Notice that the formula for standard error is actually just the formula for standard deviation but with notation adapted to reflect the fact we are examing sample means (i.e., \\(\\bar{x}\\)’s) instead of people (i.e., X’s). Often we will not talk about standard error but rather the variance of the distribution of sample means. When we do so, we are talking about the same thing - the variability in sample means - but using different units. You can see that the formula for the variance of sample means, see Formula (6.2) below, is just a squared version of the standard error equation, Formula (6.1) above. \\[\\begin{equation} \\sigma_{\\bar{x}}^2 = \\frac{\\sum{(\\bar{x} - \\bar{\\bar{x}})^2}}{k} \\tag{6.2} \\end{equation}\\] How do we interpret variance of sample means? Assuming the sample mean is an unbiased estimator of the population mean (i.e., \\(\\bar{\\bar{x}} = \\mu\\)), then the variance of the sample means is simply the average of the squared differences between sample means and the population mean. Standard error is simply the square root of the variance of sample means. Both are different ways of describing the same thing - the precision with which sample means estimate the population mean. If the variance of sample means is large, it indicates sample means differ considerably (on average) from the population mean. If the variance of sample means is small, it indicates sample means differ only slightly (on average) from the population mean. If the variance of sample means is zero, all the sample means are exactly the same as the population mean. We can calculate the variance of sample means below: many_samples %&gt;% summarise(var_of_means = var.pop(sample.mean)) %&gt;% as.data.frame() ## var_of_means ## 1 15.73355 The standard error of sample mean is just the square root of this value: many_samples %&gt;% summarise(sd_of_means = sqrt(var.pop(sample.mean))) %&gt;% as.data.frame() ## sd_of_means ## 1 3.966554 Thus, we can indicate the precision with which sample means (\\(\\bar{x}\\)) estimate the population mean (\\(\\mu\\)) using the notation below. We use \\(\\sigma_{\\bar{x}}^2\\) to refer to the variance of sample means and \\(\\sigma_{\\bar{x}}\\) to refer to the standard error of sample means. Again notice in the notation that for both of these symbols there is a subscript with an \\(\\bar{x}\\) to remind us we are talking about the variability of sample means (and not people). \\[ \\begin{aligned} \\sigma_{\\bar{x}}^2 &amp;= 15.73 \\\\ \\sigma_{\\bar{x}} &amp;= 3.97 \\\\ \\end{aligned} \\] 6.5 A short cut In the previous section we used a computer simulation to calculate the variance of sample means. This involved several steps: Obtaining the entire population Creating 50000 samples (each n = 10) from the population Calculating the mean for each of the 50000 samples Calculating the variance of the 50000 sample means as per Formula (6.2) All those steps are a lot of work - and a lot of computer time. Interestingly, we don’t need to go to all that work to determine the variance of sample means. There is a quicker way to obtain the variance of sample means. That is, there is a quicker way to determine the precision with which sample means estimate the population mean when we use a sample size of \\(n\\) = 10. Statisticians have created a short-cut formula for obtaining the variance of sample means. The equation by itself, see Formula (6.3) below, is extraordinarily simple to use. The formula, however, is not easy to understand. Over many years of teaching, we’ve seen students struggle to understand why the formula is structured in the way that it is - looking for a straightforward logic as to why the short-cut formula works. We encourage you to avoid going down that road. Understanding Formula (6.3) below is beyond the scope of this chapter and, likely, your mathematical background at this point. It was derived via a complex mathematical proof discussed in Hays (1994) if you want more information. Simply accept that there is a short-cut formula and do not try to understand the logic of the formula. Variance sample means: \\[\\begin{equation} \\sigma_{\\bar{x}}^2 = \\frac{\\sigma^2}{n} \\tag{6.3} \\end{equation}\\] You can see that with this formula the variance of sample means, Formula (6.3), is simply the variance of the individuals in the population divided by the sample size. Oddly, this short cut works and provides the variance of sample means. Notice that we don’t have to have the entire population, create thousands of samples, or go through any of the calculation work. All we need to know is the variance of the population and the sample size. In the context of the current example we can compute the variance of the sample means using this information. Recall the variance of people’s heights in the population is \\(\\sigma^2=157.5\\) and our sample size is \\(n\\) = 10. \\[ \\begin{aligned} \\sigma_{\\bar{x}}^2 &amp;= \\frac{\\sigma^2}{n} \\\\ &amp;= \\frac{157.5}{10}\\\\ &amp;= \\frac{157.5}{10}\\\\ &amp;= 15.75 \\end{aligned} \\] We see the variance of the sample means from this short-cut approach is 15.75 (i.e., \\(\\sigma_{\\bar{x}}^2\\) = 15.75). Likewise, the variance of the sample means from our simulation was 15.73; incredibly close. If we had used substantially more than 50000 samples in the simulation the 15.73 value would have been 15.75 – making the two results identical. Thus, the short-cut formula gives us the variance of sample means without having to do all the simulation work. Of course, the variance of sample means is only one of the two ways we can describe the precision of sample estimates of the population mean. Many people prefer to use standard error (i.e. standard deviation of sample means) instead. The calculation for standard error is below: \\[ \\begin{aligned} \\sigma_{\\bar{x}} &amp;= \\sqrt{\\frac{\\sigma^2}{n}} \\\\ &amp;= \\sqrt{\\frac{157.5}{10}}\\\\ &amp;= \\sqrt{\\frac{157.5}{10}}\\\\ &amp;= \\sqrt{15.75} \\\\ &amp;= 3.97 \\\\ \\end{aligned} \\] 6.6 Estimates of precision As wonderful as it is to have a short-cut formula for obtaining the variance of sample means (or standard error) there is a catch. The formula requires knowledge of the population variance (or standard deviation). In a research scenario we don’t know the mean or standard deviation of the population - that’s why we’re conducting research. Consequently, we can’t directly calculate the variance of sample mean (or standard error). Fortunately, if we have only a single study, we can use the sample variance (with n-1 in the denominator) to estimate the population variance. This estimate of the population variance may be higher or lower than the actual population variance - but it will, on average, be correct across many studies. With this estimate of the population variance in hand we can calculate an estimate of the variance of sample means (i.e, the precision of sample means) using Formula (6.4) below. Estimated variance sample means: \\[\\begin{equation} s_{\\bar{x}}^2 = \\frac{s^2}{n} \\tag{6.4} \\end{equation}\\] Estimated standard error for the mean: \\[\\begin{equation} s_{\\bar{x}} = \\sqrt{\\frac{s^2}{n}} = \\frac{s}{{\\sqrt{n}}} \\tag{6.5} \\end{equation}\\] 6.6.1 A worked example Consider a worked example below. Imagine a scenario where we do not know anything about the population of heights. Therefore we conduct a study by taking a random sample of 10 people to estimate the average height of people in the population. The sample mean is 174.3cm and the sample variance is 30.90. Therefore, our best guess of the unknown population mean is 174.3cm. Because we used a sample (a small subset of the population) we know that 174.3cm is unlikely to be the actual mean height for the population. The mean height for the population might be higher or lower than 174.3cm. Nonetheless, at this point our best guess is that the mean of the population is 174.3cm; but we recognize that this is just an estimate of the population mean and is likely off by some amount. Wouldn’t it be great to know the extent to which the sample mean might differ from the population mean? As budding statisticians, we know we can’t know that for this particular sample, but we can try to figure out how much sample means differ from the population mean on average (when using \\(n\\) = 10) to help us understand the precision of our current sample estimate (174.3cm) of the population mean. This precision information is exactly what is conveyed by the variance of sample means, \\(\\sigma_{\\bar{x}}^2\\), or standard error of sample means, \\(\\sigma_{\\bar{x}}\\). We can’t obtain these precision indices but we can estimate them (via \\(s_{\\bar{x}}^2\\) and \\(s_{\\bar{x}}\\)). We want to know the precision with which sample means estimate the population mean. Said another way, we want to know the variance of sample means (or standard error of sample means) but we only have a single study. Therefore, we have to rely on the short-cut formula for determining the variability in sample means. Unfortunately, the short-cut formula for the variance of sample means formula requires the population variance which we don’t know. We do, however, have an estimate of the population variance from our sample. The sample variance is 30.9cm\\(^2\\). Therefore, our best guess of the unknown population variance is 30.9cm\\(^2\\). Because we used a sample (a small subset of the population) we know that 30.9cm\\(^2\\) is likely to be different than the actual variance for the population. The variance for the population might be higher or lower than 30.9cm\\(^2\\). So even though our estimate of the population variance may be “off” in this single sample we are know it will be accurate in the long run averaging over many studies (see previous chapter). Nonetheless, at this point our best guess is that the variance of the population is 30.9cm\\(^2\\). We use this information to estimate the variance of sample means: \\[ \\begin{aligned} s^2_{\\bar{x}} &amp;= \\frac{s^2}{n} \\\\ &amp;= \\frac{30.90}{10} \\\\ &amp;= 3.09 \\\\ \\end{aligned} \\] Or alternatively, estimate standard error: \\[ \\begin{aligned} s_{\\bar{x}} &amp;= \\sqrt{\\frac{s^2}{n}} \\\\ &amp;= \\sqrt{\\frac{30.90}{10}} \\\\ &amp;= \\sqrt{3.09} \\\\ &amp;= 1.76 \\\\ \\end{aligned} \\] At this point we don’t know the precision of sample means when \\(n\\) = 10; that is we don’t know \\(\\sigma_{\\bar{x}}^2\\) or \\(\\sigma_{\\bar{x}}\\). We do have an estimate of the precision of sample means (i.e., with via \\(s_{\\bar{x}}^2\\) and \\(s_{\\bar{x}}\\)). When ever you calculate the variance of sample means, or standard error, based on sample data it is ALWAYS just an estimate of the actual variance of sample means or the actual standard error. That fact that an estimate of the variance of sample means is the best you can do with sample data is evident when we calculate the estimate for the many samples. We do that with the R code below: many_samples &lt;- many_samples %&gt;% mutate(est_se2 = sample.var.n_1/n) The command above calculated the estimate variance of sample means (est_se2 or \\(s_{\\bar{x}}^2\\)) for each of the 50000 samples. We can see the first few samples with the head() command. head(many_samples) ## study n sample.mean sample.var.n sample.var.n_1 est_se2 ## 1 1 10 174.3 27.810 30.90 3.090 ## 2 2 10 161.8 83.358 92.62 9.262 ## 3 3 10 173.2 139.158 154.62 15.462 ## 4 4 10 180.0 321.804 357.56 35.756 ## 5 5 10 172.8 160.956 178.84 17.884 ## 6 6 10 172.0 159.597 177.33 17.733 Inspect the est_se2 column. Notice how each of these values is an \\(s_{\\bar{x}}^2\\) number that is an estimate of \\(\\sigma_{\\bar{x}}^2\\) = 15.75. The first estimate, \\(s_{\\bar{x}}^2\\) = 3.09, is the one we did by hand above. This estimate of the variance of sample means (\\(s_{\\bar{x}}^2\\) = 3.09) is much lower than the actual variance of sample means (\\(\\sigma_{\\bar{x}}^2\\) = 15.75). Notice how the other values in the est_se2 column tend either overestimate or underestimate the variance of sample means. That is, the other studies also overestimate or underestimate the precision with which a sample mean (\\(n\\) = 10) estimates the population mean. 6.7 Bias of precision estimates At this point, you might be a bit concerned about our ability to estimate the variance of sample means ( \\(\\sigma_{\\bar{x}}^2\\) = 15.75). In the simulation above, we calculated an estimate of the variance of sample means (\\(s_{\\bar{x}}^2\\)) and placed those values in the est_se2 column. We saw that the values in this column mostly differed from the actual variance of sample means (15.75). You might wonder if these estimates of the variance of sample means are themselves biased? The answer is no - they are not biased. Our estimate of the population variance (n-1 in the denominator) was not biased so there is no reason to suspect that the estimate of the variance of sample means is biased. But we can confirm this by averaging over the 50000 samples. If the average of the est_est2 column is 15.75 (or very close) than \\(s_{\\bar{x}}^2\\) is not a biased estimate of \\(\\sigma_{\\bar{x}}^2\\) = 15.75. many_samples %&gt;% summarise(avg.of.est_se2 = mean(est_se2)) ## avg.of.est_se2 ## 1 15.72713 We see that the average of the 50000 estimates of the variance of sample means (\\(s_{\\bar{x}}^2\\)) is 15.73 which is very close to the actual value of \\(\\sigma_{\\bar{x}}^2\\) = 15.75. Any sample estimate of the variance of sample means will be off somewhat due to sampling error. But, on average, estimates of the variance of sample means will be unbiased/accurate. 6.8 Where are we? So where are we? We’ve learned that sample means may overestimate, or underestimate, the population mean. Over many studies, on average, sample means will approximate the population mean. In other words, on average, sample means are accurate. As well, we’ve learned that the variability in estimates of the population mean is referred to as precision. We can index the precision of sample means, for a given sample size, using two indices: variance of sample means and standard error of sample means (i.e., standard deviation of sample means). Both of these formulas require knowledge of the population variance - something we never have. When we conduct a single study, we get a sample mean. We can estimate how precise that sample mean is via the variance of sample means / standard error of sample means formulas. But we use an estimate of the population variance in these formulas rather than the actual population variance. As a result, when we calculate variance of sample means (or standard error) using sample data we only obtain estimates of those values. These estimates are themselves influenced by sampling error - but accurate when averaged over many studies. 6.9 Factors influencing precision The formula for variance of the sampling distribution for the mean reveals that it is influenced only by the population variance and sample size. In a research scenario, we don’t have any control over the population variance (it is what it is), but we do have control over sample size. Increasing the sample size decreases the variability in sample means - as illustrated in the formulas below. We also show in Figure 6.3 the difference that increasing the sample size makes. The larger the sample size the less sample means vary due to sampling error. A larger sample size means a more precise estimate of the population parameter. \\[ \\begin{aligned} \\sigma^2 &amp;= 157.5 \\\\ \\sigma_{\\bar{x}}^2 &amp;= \\frac{\\sigma^2}{n} = \\frac{157.5}{10} = 15.75 \\\\ \\sigma_{\\bar{x}}^2 &amp;= \\frac{\\sigma^2}{n} = \\frac{157.5}{50} = 3.15 \\\\ \\end{aligned} \\] FIGURE 6.3: Two sampling distributions for the mean. The population of individuals is presented at the top and filled with X’s to remind you they are individuals. There are more individuals than X’s. There are also two sampling distribution of means presented in the bottom part of the graph. Each sampling distribution contains 50000 means. The sampling distributions are filled with \\(\\bar{x}\\)’s to remind you that it is sample means being graphed. There are more means than \\(\\bar{x}\\)’s. You can see that by using a larger sample size (\\(n = 50\\)) there is less variability in sample means than when using a smaller sample size (\\(n = 10\\)). Additionally, a larger sample size makes the sample estimate (i.e., \\(s^2\\)) of the population variance more precise. Consequently, it makes the sample estimate (i.e., \\(s_{\\bar{x}}^2\\) or \\(s_{\\bar{x}}\\)) of the variance of sample means more precise. Therefore, increasing the sample size increases the precision of a) sample means (i.e., \\(\\bar{x}\\)) and b) precision estimates (i.e., \\(s_{\\bar{x}}^2\\) or \\(s_{\\bar{x}}\\)). 6.10 Precision for other statistics Something about this working for d-values also… FIGURE 6.4: Sampling accuracy and precision References "]
]
