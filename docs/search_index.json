[
["sampling-precision.html", "Chapter 6 Sampling Precision 6.1 Population / Individuals 6.2 Sampling distribution / sample means 6.3 Precision Indices 6.4 A short cut 6.5 Estimates 6.6 PASTE HERE", " Chapter 6 Sampling Precision In the previous chapter we focussed on examining the extent to which we could estimate a population parameter from a statistic in an unbiased manner. That is, we focused on the fact that, due to sampling error, a sample estimate (i.e., a statistic) of a population parameter will likely be wrong. Sample statistics may overestimate or underestimate a population parameter - often substantially. Consequently, we learned to think about accuracy of sample statistics, not in terms of a single study, but rather in terms of whether sample statistics correctly estimate the population parameter on average over many studies (as illustrated in Figure 6.1). When the average of many sample statistics (e.g., sample means) equal the population parameter (e.g., population mean) there is no bias and the sample statistic can be considered accurate (on average). In this chapter we focus on examining, and estimating, the variability in sample statistics. That is, to what extent will sample statistics deviate from the population parameter? We use the term precision to refer to the variability created by sampling error, see Figure 6.1. FIGURE 6.1: Sampling accuracy and precision 6.1 Population / Individuals As in the last chapter, we use a population of heights to learn about random sampling and the precision of sample estimates. We can obtain that population with the code below: library(tidyverse) library(learnSampling) pop_data &lt;- get_height_population() The glimpse() command can be used to confirm that the population contains 100,000 people. glimpse(pop_data) ## Rows: 100,000 ## Columns: 3 ## $ id &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18,… ## $ sex &lt;chr&gt; &quot;male&quot;, &quot;female&quot;, &quot;female&quot;, &quot;male&quot;, &quot;male&quot;, &quot;male&quot;, &quot;female&quot;, … ## $ height &lt;dbl&gt; 177, 150, 171, 157, 169, 187, 163, 173, 172, 193, 190, 181, 15… We can use the head() command to see the first 10 rows of the 100,00 rows. We see that each row in pop_data represents a single person. There is a column called height that contains the heights for everyone in the population. head(pop_data, 10) ## # A tibble: 10 x 3 ## id sex height ## &lt;int&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 1 male 177 ## 2 2 female 150 ## 3 3 female 171 ## 4 4 male 157 ## 5 5 male 169 ## 6 6 male 187 ## 7 7 female 163 ## 8 8 male 173 ## 9 9 female 172 ## 10 10 male 193 We can calculate the descriptive statistics for the population with the code below: pop_data %&gt;% summarise(pop_mean = mean(height), pop_var = var.pop(height), pop_sd = sd.pop(height)) %&gt;% as.data.frame() ## pop_mean pop_var pop_sd ## 1 172.4762 157.4611 12.54835 We see the mean of the population of heights is 172.5 (\\(\\mu = 172.5\\)) and the variance is 157.5 (\\(\\sigma^2 = 157.5\\)). Correspondingly, the standard deviation of the population of heights is 12.5 (\\(\\sigma = 12.5\\)); simply the square root of the variance. For clarity, we use the subscript X in notation below to make it clear we are referring the people (which are often represented by X’s). \\[ \\begin{aligned} \\mu &amp;= 172.5 \\\\ \\sigma^2 &amp;= 157.5 \\\\ \\sigma &amp;= 12.5 \\\\ \\end{aligned} \\] 6.2 Sampling distribution / sample means A sampling distribution is usually thought of as being composed of an infinite number of samples. For pedagogical purposes, we will use a sampling distribution of just 50000 samples. This is a large numbers of samples that will lead us to largely the same conclusions as using a impractical infinite number of samples. As per the last chapter we obtain the 50000 samples with code below: many_samples &lt;- get_M_samples(pop.data = pop_data, pop.column.name = height, n = 10, number.of.samples = 50000) We can use the head() command to see the first few rows of many_samples. Every row represents a sample of 10 people. For each row we have the sample mean and variance (using n-1). head(many_samples) ## study n sample.mean sample.var.n sample.var.n_1 ## 1 1 10 174.3 27.810 30.90 ## 2 2 10 161.8 83.358 92.62 ## 3 3 10 173.2 139.158 154.62 ## 4 4 10 180.0 321.804 357.56 ## 5 5 10 172.8 160.956 178.84 ## 6 6 10 172.0 159.597 177.33 We will study the precision of sample means as estimate of the population mean using the values in the sample.mean column. Each of the 50000 values in the sample.mean column is a sample mean (\\(\\bar{x}\\)), based on \\(n\\) = 10. Each sample mean provides an estimate of the population mean (\\(\\mu = 172.5\\)). The sample means often overestimate or underestimate the population mean. We can see this using the code below which tells use the smallest sample mean is 155.6 (\\(\\bar{x} = 155.6\\)) and the largest sample mean is 188.8 (\\(\\bar{x} = 188.8\\)). Both are estimates of the population mean (\\(\\mu = 172.5\\)) but differ from that value due to sampling error (i.e., the fact sample means are based on a small subset of the population). many_samples %&gt;% summarise(min_mean = min(sample.mean), max_mean = max(sample.mean)) ## min_mean max_mean ## 1 155.6 188.8 The 50000 means in the sample.mean column form a sampling distribution; specifically, the sample distribution of the mean. 6.3 Precision Indices Examine Figure 6.2 below. The top part of this figure illustrates the variability in the 100,000 people (represented by X’s). There are more people than X’s; the X’s are a reminder it is a distribution of people. The bottom part of this figure illustrates the variabilty in sample means - each based on 10 people. Each sample mean is an estimate of the population of mean of 172.5 cm. There are more sample means than \\(\\bar{x}\\)’s; the \\(\\bar{x}\\)’s are a reminder it is a distribution of sample means. When we describe how precisely sample means estimate the population mean we are usually refering to the width of the this distribution of means. FIGURE 6.2: Sampling distribution of the mean. The population of individuals is presented at the top and filled with X’s to remind you they are individuals. There are more individuals than X’s. The sampling distribution of means is presented in the bottom part of the graph. The sampling distribution of means is filled with \\(\\bar{x}\\)’s to remind you that it is sample means being graphed. There are more means than \\(\\bar{x}\\)’s. The population mean (green line) and the mean of sample means (blue line) are in the same spot, indicating high accuracy (i.e., no bias). The most common way of referring to the width of this distribution of sample mean is with the term standard error. Standard error is simply the standard deviation of the sample means. We calculate the standard error of the mean with using Formula (6.1) below. We use k in the formula to refer to the number of sample mean in the distribution. \\[\\begin{equation} \\sigma_{\\bar{x}} = \\sqrt{\\frac{\\sum{(\\bar{x} - \\bar{\\bar{x}})^2}}{k}} \\tag{6.1} \\end{equation}\\] Notice that the formula for standard error is actually just the formula for standard deviation but with notation adapted to reflect the fact we are examing sample means instead of people. Often we will not talk about standard error but rather the variance of the distribution of sample means. When we do so, we are talking about the same thing - the variability in sample mean - but just using different units. You can see the formula for the variance in sample means, see Formula (6.2) below, is the just a squared version of the standard error equation, Formula (6.1) above. \\[\\begin{equation} \\sigma_{\\bar{x}}^2 = \\frac{\\sum{(\\bar{x} - \\bar{\\bar{x}})^2}}{k} \\tag{6.2} \\end{equation}\\] How do we interpret variance of sample means? Assuming the sample mean is an unbiased estimator of the population mean (i.e., \\(\\bar{\\bar{x}} = \\mu\\)), then the variance of the sample means is simply the average of the squared differences between sample means and the population mean. Standard error is simply the square root of the variance of sample means. Both are different ways of describing the same things - the extent to which sample means differ from the population mean. If the variance of sample means is large, it indicates sample means differ considerably (on average) from the population mean. If the variance of sample means is small, it indicates sample means differ only slightly (on average) from the population mean. If the variance of sample means is zero, all the sample means are exactly the same as the population mean. We can calculate the variance of sample means below: many_samples %&gt;% summarise(var_of_means = var(sample.mean)) %&gt;% as.data.frame() ## var_of_means ## 1 15.73387 The standard error of sample mean is just the square root of this value: many_samples %&gt;% summarise(sd_of_means = sqrt(var(sample.mean))) %&gt;% as.data.frame() ## sd_of_means ## 1 3.966594 Thus, using symbols: \\[ \\begin{aligned} \\sigma_{\\bar{x}}^2 &amp;= 15.73 \\\\ \\sigma_{\\bar{x}} &amp;= 3.97 \\\\ \\end{aligned} \\] 6.4 A short cut In the previous section we used a computer simulation to calculate the variance of sample means. This involved a many steps: Obtaining the full population Obtain 50000 samples (each n = 10) from the population Calculating for each sample the mean Calculating the variance of the 50000 sample mean as per Formula (6.2) All those steps are a lot of work - and a lot of computer time. Interestingly, we don’t need to go to all that work to determine the variance of sample means. There is a quicker way to obtain the variance of sample means. That is, there is a quicker way to determine the precision with which sample means estimate the population mean when we use a sample size of \\(n\\) = 10. Statisticians have created a short-cut formula for obtaining the variance of sample means. The equation by itself, see Formula (6.3) below, is extraordinarily simple to use. The formula, however, is not easy to understand. Over many years of teaching, we’ve seen students struggle to understand why the formula is structured in the way that it is - looking for a straightforward logic as to why the short-cut formula works. We encourage you to avoid going down that road. Understanding Formula (6.3) below is beyond the scope of this chapter. It was derived via a mathematical proof discussed in HaysXXXX. Simply accept that there is a short cut formula and do not try to understand the logic of the formula. Variance sample means: \\[\\begin{equation} \\sigma_{\\bar{x}}^2 = \\frac{\\sigma^2}{n} \\tag{6.3} \\end{equation}\\] You can see that with this formula the variance of sample means, Formula (??), is simply the variance of the individuals in the population divided by the sample size. Oddly, this short cut works and provides the variance of sample means. Notice that we don’t have to have the full population, create thousands of sample, or go through any of that calculation work. All we need to know is the standard deviation of the population and the sample size. In the context of the current example we can compute the variance of the sample means using this information. Recall the people’s height in the population is \\(\\sigma^2=157.5\\) and our sample size is \\(n\\) = 10. \\[ \\begin{aligned} \\sigma_{\\bar{x}}^2 &amp;= \\frac{\\sigma^2}{n} \\\\ &amp;= \\frac{157.5}{10}\\\\ &amp;= \\frac{157.5}{10}\\\\ &amp;= 15.75 \\end{aligned} \\] We see the variance of the sample means from this short-cut approach is 15.75. Likewise contrast, the variance of the sample means from our simulation was 15.73; incredibly close. If we had use many more samples in the simulation the 15.73 value would have been 15.75; make the two results identical. Thus, the short-cut formula gives us the variance of sample mean without having to do all the simulation work. Of course, variance of sample means in only one of the ways we describe the precision of sample estimates of the population mean. Many people prefer to use standard error (i.e. standard deviation of sample means) instead. The calculation for standard error is below: \\[ \\begin{aligned} \\sigma_{\\bar{x}} &amp;= \\sqrt{\\frac{\\sigma^2}{n}} \\\\ &amp;= \\sqrt{\\frac{157.5}{10}}\\\\ &amp;= \\sqrt{\\frac{157.5}{10}}\\\\ &amp;= \\sqrt{15.75} \\\\ &amp;= 3.97 \\\\ \\end{aligned} \\] 6.5 Estimates As wonderful as it is to have a short-cut formula for obtaining the variance of sample means (or standard error) there is a catch. The formula requires knowledge of the population variance (or standard deviation), In research scenario we don’t the mean or standard deviation of the population. Consequently, we can’t calculate the variance of sample mean (or standard error). Fortunately, with just a single study we can estimate the variance of sample means when using a given sample size. To do so, we recall that the sample variance (with n-1 in the denominator) is an estimate of the population variance. Therefore, we can use an estimate of the population variance to calculate an estimate of the variance of sample mean (or an estimate of standard error). We can do do with the formulas below: Estimate variance of sample means: Formula Estimated standard error (Standard deviation of sample means) Formula Consider a worked example below. If using sample data (n = 10) we have a sample variance of xxx. That is, xx = xxx is our estimate of the population variance. We can estimate the variance of sample means or estimate standard error. When every you calculate the variance of sample mean or standard error based on sample data it is ALWAYS just an estimate of the actual variance of sample mean or the actual standard error. This is evident when you imagine calculating this for many sample as we do below with R code. This code calculate a new column in the many sample data set s2xbar - the ESTIMATED variance of sample means. We used the head() command to see the first few rows of the data. Each row represents a different sample of 10 people. The column sample.mean contains the sample mean which is an estimate of the population mean. The column XX contains the sample variance (using n-1) which is an estimate of the population variance. Notice how each sample/row has a different estimate of the population variance. These estimate will be correct on average even though a single estimate if likely incorrect. The column XX is calculated using the sample variance and the sample size of 10 via Formula XX. Each value in this column is an estimate of the variance of sample means (see Figure XX B). That is each value in this column is an estimate of XX(value) but differs to sampling error. Thus, anytime we calculate the standard error (or variance of sample means) from sample data we are likely incorrect in that case, but correct in the long run. We can see that averaging over many estimate of the variance of sample means provides the same number… 6.6 PASTE HERE #VAR \\[\\begin{equation} \\sigma_{\\bar{x}}^2 = \\frac{\\sum{(\\bar{x} - \\bar{\\bar{x}})^2}}{k} \\tag{6.2} \\end{equation}\\] \\[\\begin{equation} \\sigma_{\\bar{x}}^2 = \\frac{\\sigma^2}{n} \\tag{6.3} \\end{equation}\\] \\[\\begin{equation} s_{\\bar{x}}^2 = \\frac{s^2}{n} \\tag{6.4} \\end{equation}\\] #SE \\[\\begin{equation} \\sigma_{\\bar{x}} = \\sqrt{\\frac{\\sigma^2}{n}} = \\frac{\\sigma}{{\\sqrt{n}}} \\tag{6.5} \\end{equation}\\] \\[\\begin{equation} s_{\\bar{x}} = \\sqrt{\\frac{s^2}{n}} = \\frac{s}{{\\sqrt{n}}} \\tag{6.6} \\end{equation}\\] many_samples &lt;- many_samples %&gt;% mutate(est_se2 = sample.var.n_1/n) many_samples %&gt;% summarise(avg.of.est_se2 = mean(est_se2)) ## avg.of.est_se2 ## 1 15.72713 "]
]
